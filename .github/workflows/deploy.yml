name: Deploy Projeto para GitHub Pages

on:
  push:
    branches:
      - main # O workflow roda quando hÃ¡ um push para o branch 'main'

jobs:
  build-and-deploy:
    # PermissÃµes necessÃ¡rias para que a action de deploy funcione
    permissions:
      contents: write
      pages: write
      id-token: write

    runs-on: ubuntu-latest # O ambiente onde o job serÃ¡ executado
    
    defaults:
      run:
        working-directory: ./site # Define a pasta 'site' como diretÃ³rio de trabalho padrÃ£o

    steps:
      - name: ğŸ“¦ Checkout do RepositÃ³rio
        uses: actions/checkout@v4

      - name: âš™ï¸ Configurar Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20' # Use a versÃ£o do Node.js que seu projeto utiliza
          cache: 'npm' # Habilita o cache de dependÃªncias do npm
          cache-dependency-path: ./site/package-lock.json

      - name: â¬‡ï¸ Instalar DependÃªncias
        run: npm ci

      - name: ğŸ—ï¸ Fazer Build do Projeto
        # Este comando irÃ¡ compilar seu projeto React/TypeScript. 
        # Certifique-se de que seu 'package.json' na pasta 'site' tenha um script 'build'.
        run: npm run build 

      - name: ğŸš€ Deploy para GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }} # Token fornecido automaticamente pelo GitHub
          publish_dir: ./site/build # O diretÃ³rio onde a build de produÃ§Ã£o (os arquivos estÃ¡ticos) estÃ¡. 
                                    # Ajuste para a sua configuraÃ§Ã£o (ex: ./build, ./dist, etc.)
          publish_branch: gh-pages # A branch que o GitHub Pages usarÃ¡ para servir o site
          force_orphan: true # Cria um novo histÃ³rico para o branch de deploy
